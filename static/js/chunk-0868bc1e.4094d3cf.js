(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0868bc1e"],{"0f66":function(e,t,a){"use strict";a.d(t,"h",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"i",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"g",(function(){return c})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"j",(function(){return f})),a.d(t,"k",(function(){return p})),a.d(t,"d",(function(){return m}));var n=a("b775"),r=function(e){return Object(n["a"])({url:"/api/vm-service/region/search",params:e})};function i(e){return Object(n["a"])({url:"/api/vm-service/region",method:"POST",data:e})}function o(e){return Object(n["a"])({url:"/api/vm-service/region/"+e.id,method:"PUT",data:e})}function s(e){return Object(n["a"])({url:"/api/vm-service/region/"+e,method:"DELETE"})}function c(e){return Object(n["a"])({url:"/api/vm-service/node/search",params:e})}function l(e){return Object(n["a"])({url:"/api/vm-service/node",method:"POST",data:e})}var u=function(){return Object(n["a"])({url:"/api/vm-service/businessType"})},d=function(e,t){return Object(n["a"])({url:"/api/vm-service/node/"+e,method:"PUT",data:t})},f=function(e){return Object(n["a"])({url:"/api/user-service/partner/search",params:e})},p=function(e){return Object(n["a"])({url:"/api/vm-service/node/vmList/"+e})},m=function(e){return Object(n["a"])({url:"/api/vm-service/node/"+e,method:"DELETE"})}},"4bd9":function(e,t,a){},6384:function(e,t,a){"use strict";a("bca9")},"70a7":function(e,t,a){},"7ecb":function(e,t,a){"use strict";a("4bd9")},8694:function(e,t,a){"use strict";a("9126")},"8aa8":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-container"},[a("div",{staticClass:"search operation"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"点位搜索："}},[a("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),a("el-form-item",{attrs:{label:"区域搜索："}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择活动区域"},model:{value:e.areaName,callback:function(t){e.areaName=t},expression:"areaName"}},e._l(e.areaSearchList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",[a("Button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[a("span",[a("svg",{staticStyle:{width:"16px",height:"16px","vertical-align":"middle",cursor:"pointer",color:"#fff"},attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-search"}})])]),e._v(" 查询")])],1)],1)],1),a("div",{staticClass:"Table"},[a("div",{staticClass:"operation"},[a("Button",{attrs:{type:"create"},nativeOn:{click:function(t){return e.add(t)}}},[a("span",[a("svg",{staticClass:"create",staticStyle:{width:"16px",height:"16px","vertical-align":"middle",cursor:"pointer",color:"#fff"},attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-Create"}})])]),e._v(" 新建")])],1),a("div",[a("el-table",{staticClass:"operation",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":{background:"#eef1f6"},size:"mini"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"80"}}),e._l(e.tableTltle,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e.name,label:e.lable}})})),a("el-table-column",{attrs:{prop:"operate",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"#5f84ff"},attrs:{type:"text"},nativeOn:{click:function(a){return e.showDetails(t.row)}}},[e._v("查看详情")]),a("el-button",{staticStyle:{color:"#5f84ff"},attrs:{type:"text"},nativeOn:{click:function(a){return e.showEdit(t.row)}}},[e._v("修改")]),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},nativeOn:{click:function(a){return e.delPoint(t.row)}}},[e._v("删除")])]}}])})],2)],1),a("div",{staticClass:"page operation",staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticClass:"content"},[a("span",[e._v("总共"+e._s(e.totalCount)+"记录 第"+e._s(e.pageIndex)+"/"+e._s(e.totalPage)+"页")])]),a("div",[a("el-button",{staticClass:"btn-prev",attrs:{disabled:1===this.pageIndex},on:{click:function(t){return e.prevClick()}}},[e._v("上一页")]),a("el-button",{staticClass:"btn-next",attrs:{disabled:this.pageIndex===this.totalPage},on:{click:function(t){return e.nextClick()}}},[e._v("下一页")])],1)]),a("AddPoint",{ref:"AddPoint",attrs:{visible:e.dialogFormVisible,areaSearchList:e.areaSearchList},on:{"update:visible":function(t){e.dialogFormVisible=t},"add-success":e.getPointSearchApi}}),a("NodeDetails",{ref:"NodeDetails",attrs:{infoVisible:e.infoVisible},on:{"update:infoVisible":function(t){e.infoVisible=t},"update:info-visible":function(t){e.infoVisible=t}}})],1)])},r=[],i=a("c7eb"),o=a("1da1"),s=(a("d3b7"),a("159b"),a("ac1f"),a("1276"),a("b0c0"),a("9395")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.formData.id?"修改点位":"新增点位",visible:e.visible,width:"40%"},on:{close:e.onClose,open:e.openDialog}},[a("el-form",{ref:"form",attrs:{"label-width":"140px",model:e.formData,rules:e.formRules}},[a("el-form-item",{attrs:{label:"点位名称：",prop:"name"}},[a("el-input",{attrs:{maxlength:"15","show-word-limit":""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"所在区域：",prop:"regionId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formData.regionId,callback:function(t){e.$set(e.formData,"regionId",t)},expression:"formData.regionId"}},e._l(e.areaSearchList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"所属商圈：",prop:"businessId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formData.businessId,callback:function(t){e.$set(e.formData,"businessId",t)},expression:"formData.businessId"}},e._l(e.businessAreaList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"归属合作商：",prop:"ownerId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formData.ownerId,callback:function(t){e.$set(e.formData,"ownerId",t)},expression:"formData.ownerId"}},e._l(e.partnerList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"详细地址：",prop:"selections"}},[a("el-cascader",{attrs:{size:"large",options:e.options,placeholder:"请输入",clearable:""},on:{change:e.handleChange},model:{value:e.formData.selections,callback:function(t){e.$set(e.formData,"selections",t)},expression:"formData.selections"}})],1),a("el-form-item",{attrs:{prop:"addr2"}},[a("el-input",{attrs:{placeholder:"请输入详细地址",type:"textarea",maxlength:"60","show-word-limit":""},model:{value:e.formData.addr2,callback:function(t){e.$set(e.formData,"addr2",t)},expression:"formData.addr2"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{"background-color":"#fbf4f0 !important",color:"#655b56 !important"},nativeOn:{click:function(t){return e.onClose()}}},[e._v("取 消")]),a("Button",{attrs:{type:"create"},nativeOn:{click:function(t){return e.onSave(t)}}},[e._v("确 定")])],1)],1)],1)},l=[],u=a("5530"),d=(a("a15b"),a("ef6c")),f=a("0f66"),p={props:{visible:{type:Boolean,required:!0},areaSearchList:{type:Array,default:function(){return[]}}},data:function(){return{formData:{name:"",regionId:"",businessId:"",ownerId:"",addr:"",addr2:"",selections:[]},formRules:{name:[{required:!0,message:"请输入",trigger:"blur"}],regionId:[{required:!0,message:"请输入",trigger:"change"}],businessId:[{required:!0,message:"请输入",trigger:"change"}],ownerId:[{required:!0,message:"请输入",trigger:"change"}],addr2:[{required:!0,message:"请输入",trigger:"blur"}],selections:[{required:!0,message:"请输入",trigger:"change"}]},businessAreaList:[],partnerList:[],options:d["regionData"]}},methods:{onClose:function(){this.$emit("update:visible",!1),this.formData={name:"",regionId:"",businessId:"",ownerId:"",addr:"",addr2:"",selections:[]}},onSave:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate();case 2:if(t.prev=2,!e.formData.id){t.next=14;break}return e.formData.addr+="-"+e.formData.addr2,a="",e.partnerList.forEach((function(t){t.id===e.formData.ownerId&&(a=t.name)})),t.next=9,Object(f["f"])(e.formData.id,Object(u["a"])(Object(u["a"])(Object(u["a"])({},e.formData),e.formData),{},{areaCode:e.formData.selections[e.formData.selections.length-1],createUserId:e.formData.createUserId,ownerName:a}));case 9:e.$message.success("修改成功"),e.onClose(),e.$emit("add-success"),t.next=22;break;case 14:return e.formData.addr+="-"+e.formData.addr2,n="",e.partnerList.forEach((function(t){t.id===e.formData.ownerId&&(n=t.name)})),t.next=19,Object(f["a"])(Object(u["a"])(Object(u["a"])({},e.formData),{},{areaCode:e.formData.selections[e.formData.selections.length-1],createUserId:1,ownerName:n}));case 19:e.$message.success("新增点位成功"),e.onClose(),e.$emit("add-success");case 22:t.next=27;break;case 24:t.prev=24,t.t0=t["catch"](2),e.$message.error("操作失败");case 27:case"end":return t.stop()}}),t,null,[[2,24]])})))()},openDialog:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a,n,r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["c"])();case 2:return a=t.sent,n=a.data,e.businessAreaList=n,t.next=7,Object(f["j"])({pageSize:1e4});case 7:r=t.sent,e.partnerList=r.data.currentPageRecords;case 9:case"end":return t.stop()}}),t)})))()},handleChange:function(e){console.log(e);var t=[];e.forEach((function(e){t.push(d["CodeToText"][e])})),this.formData.addr=t.join("-")}},components:{Button:s["a"]}},m=p,b=(a("6384"),a("2877")),h=Object(b["a"])(m,c,l,!1,null,"3a3529e1",null),v=h.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"点位详情",visible:e.infoVisible,width:"50%"},on:{close:e.onClose,open:e.openDialog}},[a("el-form",{ref:"form",attrs:{"label-width":"100px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.pointDetailList,"empty-text":"暂无数据","header-cell-style":{background:"#eef1f6"}}},[e._v(" > "),a("el-table-column",{attrs:{type:"index",label:"序号",width:"100"}}),e._l(e.tableTltle,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e.name,label:e.lable}})}))],2)],1)],1)},w=[],x=a("5a0c"),D=a.n(x),O={name:"regionDetails",components:{},props:{infoVisible:{type:Boolean,required:!0}},created:function(){},data:function(){return{pointId:"",pointDetailList:[],tableTltle:[{name:"innerCode",lable:"机器编号"},{name:"vmStatus",lable:"设备状态"},{name:"updateTime",lable:"最后一次供货时间"}]}},methods:{onClose:function(){this.$emit("update:infoVisible",!1)},getPointDetail:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["k"])(e.pointId);case 2:a=t.sent,n=a.data,console.log(n),n.forEach((function(e){e.vmStatus=e.vmStatus?"运营":"未投放",e.updateTime=D()(e.updateTime).format("YYYY.MM.DD HH:mm:ss")})),e.pointDetailList=n;case 7:case"end":return t.stop()}}),t)})))()},openDialog:function(){this.getPointDetail()}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){}},j=O,k=(a("9ad1"),Object(b["a"])(j,g,w,!1,null,"584a467f",null)),I=k.exports,y={data:function(){return{keywords:"",areaName:"",areaSearchList:[],totalCount:"",totalPage:"",pageIndex:"",btnLoading:!1,tableTltle:[{name:"name",lable:"点位名称"},{name:"region.name",lable:"所在区域"},{name:"businessType.name",lable:"商圈类型"},{name:"ownerName",lable:"合作商"},{name:"detailAddress",lable:"详细地址"}],tableData:[],loading:!1,detailVisible:!1,dialogFormVisible:!1,infoVisible:!1,value:""}},created:function(){this.getPointSearchApi(),this.getAreaSearchInput()},methods:{add:function(){this.dialogFormVisible=!0},search:function(){this.keywords=this.value,this.getPointSearchApi()},getAreaSearchInput:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["h"])({pageIndex:1,pageSize:1e4});case 2:a=t.sent,n=a.data,e.areaSearchList=n.currentPageRecords,console.log(e.areaSearchList);case 6:case"end":return t.stop()}}),t)})))()},getPointSearchApi:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(f["g"])({pageIndex:e.pageIndex,pageSize:10,name:e.keywords,regionId:e.areaName});case 3:a=t.sent,n=a.data,console.log(n),e.pageIndex=n.pageIndex,e.totalCount=n.totalCount,e.totalPage=n.totalPage,n.currentPageRecords.forEach((function(e){var t=e.addr.split("-"),a=t[t.length-1];e.detailAddress=a})),e.tableData=n.currentPageRecords,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},showDetails:function(e){var t=this;return Object(o["a"])(Object(i["a"])().mark((function a(){return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log(e),t.$refs.NodeDetails.pointId=e.id,t.infoVisible=!0;case 3:case"end":return a.stop()}}),a)})))()},showEdit:function(e){var t=this;return Object(o["a"])(Object(i["a"])().mark((function a(){var n,r;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.dialogFormVisible=!0,t.$refs.AddPoint.formData.id=e.id,t.$refs.AddPoint.formData.name=e.name,t.$refs.AddPoint.formData.regionId=e.regionId,t.$refs.AddPoint.formData.businessId=e.businessId,t.$refs.AddPoint.formData.ownerId=e.ownerId,n=e.addr.split("-"),t.$refs.AddPoint.formData.addr2=n[n.length-1],r=[],4===n.length?r.push(d["TextToCode"][n[0]].code,d["TextToCode"][n[0]][n[1]].code,d["TextToCode"][n[0]][n[1]][n[2]].code):3===n.length&&r.push(d["TextToCode"][n[0]].code,d["TextToCode"][n[0]][n[1]].code),t.$refs.AddPoint.formData.selections=r,t.$refs.AddPoint.formData.createUserId=e.createUserId;case 12:case"end":return a.stop()}}),a)})))()},delPoint:function(e){var t=this;return Object(o["a"])(Object(i["a"])().mark((function a(){return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$confirm("此操作将永久删除该区域, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 3:return a.next=5,Object(f["d"])(e.id);case 5:t.$message.success("删除成功"),t.getPointSearchApi(),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](0),console.log(a.t0);case 12:case"end":return a.stop()}}),a,null,[[0,9]])})))()},nextClick:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.pageIndex++,e.getPointSearchApi();case 2:case"end":return t.stop()}}),t)})))()},prevClick:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.pageIndex--,e.getPointSearchApi();case 2:case"end":return t.stop()}}),t)})))()}},components:{Button:s["a"],AddPoint:v,NodeDetails:I}},S=y,C=(a("8694"),Object(b["a"])(S,n,r,!1,null,"556f926d",null));t["default"]=C.exports},9126:function(e,t,a){},9395:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{staticClass:"my-btn",class:e.type},[a("span",[e._t("default")],2)])},r=[],i={name:"Button",components:{},props:{type:{type:String,default:""}},created:function(){},data:function(){return{}}},o=i,s=(a("7ecb"),a("2877")),c=Object(s["a"])(o,n,r,!1,null,"79382a4a",null);t["a"]=c.exports},"9ad1":function(e,t,a){"use strict";a("70a7")},bca9:function(e,t,a){}}]);